<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>Debojyoti Ghosh - Research</title>
<link href="http://fonts.googleapis.com/css?family=Arvo" rel="stylesheet" type="text/css" />
<link href="http://fonts.googleapis.com/css?family=Coda:400,800" rel="stylesheet" type="text/css" />
<link href="../style.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>
<div id="menu-wrapper">
	<div id="menu">
		<ul>
			<li><a href="../index.html">Home</a></li>
			<li><a href="../resume.html">Resume</a></li>
			<li><a href="../publications.html">Publications</a></li>
			<li><a href="../research.html">Research</a></li>
			<li class="current_page_item"><a href="../misc.html">Codes/Misc</a></li>
		</ul>
	</div>
	<!-- end #menu -->
</div>
<div id="header-wrapper">
	<div id="header">
		<div id="logo">
			<h1><a href="#"><span>Debojyoti Ghosh</span></a></h1>
		</div>
	</div>
</div>
<div id="wrapper">
	<!-- end #header -->
	<div id="page">
		<div id="page-bgtop">
			<div id="page-bgbtm">
				<div id="content">
						
				<h3>TridiagLU - Parallel Direct Solver for Tridiagonal Systems</h3>
        <p></p> 
        <p>
        This code is a work-in-progress. The Git commit messages in the repository show the latest progress like bugfixes, addition of features, etc.<br>
        </p> 
				<h4>Download</h4>
        <p></p>
        <p>
        With Bitbucket account and SSH keys set up:
        <h6>git clone <a href="git@bitbucket.org:deboghosh/tridiaglu.git", target=blank>git@bitbucket.org:deboghosh/tridiaglu.git</a> </h6>
        </p>
        <p>
        Otherwise:
        </p>
        <h6>git clone <a href="https://bitbucket.org/deboghosh/tridiaglu.git", target=blank>https://bitbucket.org/deboghosh/tridiaglu.git </a> </h6>
        </p>
				<h4>Overview</h4>
        <p></p>
        <p>
          This is my implementation of a direct solver (LU decomposition) for non-periodic tridiagonal systems of equations in serial and parallel (MPI). It can solve a single system as well as a stack of independent systems. The latter is useful, for example, for compact finite-difference schemes applied to multi-dimensional problems. The following functions are available:-

           <li><strong><em>tridiagLU</em></strong>(<em>a,b,c,x,n,ns,r,m</em>) (Parallel tridiagonal solver)</li>
           <li><strong><em>tridiagLUGS</em></strong>(<em>a,b,c,x,n,ns,r,m</em>) (Tridiagonal solver based on a gather-and-solve strategy)</li>
           <li><strong><em>tridiagIterJacobi</em></strong>(<em>a,b,c,x,n,ns,r,m</em>) (Iterative tridiagonal solver using the Jacobi method)</li>
           <p></p>

        <p>A <strong>test code</strong> is provided in <em>/src/Test</em> to check the tridiagonal solvers and test the walltimes. It runs a series of tests - solution of an identity matrix, upper-triangular tridiagonal matrix and a full tridiagonal matrix with random entries and right-hand sides to check for accuracy. It measures the walltimes by solving a set of systems repeatedly.</p>


        <h4>Algorithm / References</h4>
        <p></p>
        <p><em><strong>tridiagLU()</strong></em> solves the parallel tridiagonal system by rearranging the equations such that the last points of each sub-domain are grouped at the end. This results in a parallel elimination of the interior points, followed by the inversion of a reduced system of size <em>nproc-1</em>, whose elements are distributed as one element in each process except the root. This reduced system can either be solved by gathering on one processor, solving (in serial) and scattering back - <strong><em>tridiagLUGS()</em></strong>, or iteratively by <strong><em>tridiagIterJacobi()</em></strong>. Dr. <a href="http://www.mcs.anl.gov/~fischer/", target=blank>Paul Fischer</a> explained the algorithm and guided me in implementing this. <a href="files/tridiaglu_algorithm.pdf"><strong>Here</strong></a> is a rough sketch of the algorithm.</p>

        <p><em><strong>tridiagLUGS()</strong></em> Each of the "ns" systems is gathered on one processor, solved in serial, and the solution scattered back. The parallelism lies in solving the "ns" different systems on multiple processors (i.e., each processor solves ~ns/nproc number of systems in serial).

        <p><em><strong>tridiagIterJacobi()</strong></em> uses Jacobi iterations to solve the system. See <a href="http://mathworld.wolfram.com/JacobiMethod.html", target=blank><strong>here</strong></a>.</p>

        <h4>Scalability</h4>
        <p></p>
        <p>
        There are some scalability plots available <a href="tridiaglu_scalability.html"><strong>here</strong></a>.
        </p>

        <h4>Function Arguments</h4>
        <p></p>
        <p>
        <li> <strong>a</strong> (Size: [0,ns-1]x[0,n-1], Type: double*) - subdiagonal entries</li>
        <li> <strong>b</strong> (Size: [0,ns-1]x[0,n-1], Type: double*) - diagonal entries</li>
        <li> <strong>c</strong> (Size: [0,ns-1]x[0,n-1], Type: double*) - superdiagonal entries</li>
        <li> <strong>x</strong> (Size: [0,ns-1]x[0,n-1], Type: double*) - right-hand side (solution)</li>
        <li> <strong>n</strong> (Type: int) - local size of the system</li>
        <li> <strong>ns</strong> (Type: int) - number of systems to solve</li>
        <li> <strong>r</strong>  (Type: TridiagLU*) - structure containing the parameters and runtimes (see README or include/tridiagLU.h for explanation)</li>
        <li> <strong>m</strong> (Type: MPIContext*) - MPI Communicator (NULL for serial)</li>
        </p>
        <p>Return value (int): 0 (successful solve), -1 (singular system)</p>
        <p>
         Notes:-
         <li>x contains the final solution (right-hand side is replaced)</li>
         <li>a,b,c are not preserved</li>
         <li>On rank=0, a[0] has to be zero.</li>
         <li>On rank=nproc-1,  c[n-1] has to be zero.</li>
        </p>

        <h4>Compiling</h4>
        <p></p>
        <p>
        The following steps should compile the code (the default prefix is the source folder
        itself, so the binary will be installed in <em>tridiaglu/bin</em>):
          <h6> autoreconf -i</h6>
          This will generate the required files for:<br>
          <h6> [CFLAGS="..."] ./configure [--with-mpidir=/path/to/mpi] [--prefix=/install/dir]</h6>
          <h6> make</h6>
          <h6> make install</h6>
          <br>
          ** A serial version can be compiled using the "-Dserial" compile flag.<br>
          ** If MPI is unavailable or the configure script is unable to detect MPI, then a 
             serial version of the code will get compiled.<br>
             </p>
        
        <h4>Testing</h4>
        <p></p>
        <p>
          Compiling the code results in compiling the tridiagonal solver functions as well as a code
          to test their performance and walltimes. The installed executable runs this test code.
          <h6> [/path/to/mpi/bin/]mpiexec -n $NPROC /path/to/TRIDIAGLU </h6><br>
          The run directory must contain a file "<strong>input</strong>" containing three integers: size of the system, number
          of systems and number of solves (for walltime measurements).<br>
        </p>
        <p>The errors reported should be machine-zero.</p>

        <h4>Using</h4>
        <p></p>
        <p>The test code demonstrates how to call these functions, including setting up the arrays <em>a</em>, <em>b</em>, <em>c</em> and <em>x</em> as well as the other arguments. To use these functions in another code, do either of the following:
        </p>
        <p>
        Copy the header file <em><strong>include/tridiagLU.h</strong></em> to the include folder of the code calling these functions. Copy all the source files in <em>src/TridiagLU/</em> to the the code's src directory and include them while compiling.<br>
        <br>
        *OR*
        <br>
        <br>
        Place <em><strong>include/tridiagLU.h</strong></em> where the compiler can find it (or use the compiler flag <em><strong>"-I/path/to/tridiagLU.h"</strong></em> while compiling) and include <em><strong>$build_dir/src/TridiagLU/libTridiagLU.a</strong></em> while linking.

				</div>
				<!-- end #content -->
				<div id="sidebar">

        <h3>TridiagLU</h3>
        <li><a href="tridiaglu.html">Overview</a></li>
        <li><a href="https://bitbucket.org/deboghosh/tridiaglu/src", target="blank">View Source</a></li>
        <p></p>

        <h3>Results</h3>
        <li><a href="tridiaglu_scalability.html">Scalability</a></li>
        <p></p>

				<h3>Quick Links</h3>
				<li><a href="hypar.html">HyPar</a></li>
				<li><a href="ibcartins3d.html">IBCartINS3D</a></li>
				<li><a href="tridiaglu.html">TridiagLU</a></li>
        <p></p>
        <h3>Misc</h3>
        <br>
        <a href="petsc.html">PETSc Installation</a><br><br>
        Overture Installation
        <li><a href="overture_fusion.html">LCRC Clusters</a></li>
        <li><a href="overture_mcslinux.html">Linux Desktop</a></li>
        <p></p>
        <p><a href="https://bitbucket.org/deboghosh", target="blank">My Bitbucket profile</a></p>
	</div>
				<!-- end #sidebar -->
				<div style="clear: both;">&nbsp;</div>
			</div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p>Debojyoti Ghosh, Postdoctoral Research Associate, MCS Division, Argonne National Laboratory. Design by <a href="http://www.freecsstemplates.org">FCT</a>.</p>
</div>
<!-- end #footer -->
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=8725416; 
var sc_invisible=1; 
var sc_security="0c597bb9"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/8725416/0/0c597bb9/1/"
alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>
